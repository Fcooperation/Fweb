<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FCHAT - Chat</title>
<style>
  body {
    font-family: 'Poppins','Segoe UI',sans-serif;
    background: #fff;
    color: #000;
    margin: 0;
    padding: 20px;
  }
  .user-details {
    background: #f5f5f5;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .user-details img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    display: block;
    margin-bottom: 10px;
  }
  .user-details h2 {
    margin: 5px 0;
    font-size: 22px;
  }
  .user-details p {
    margin: 3px 0;
    font-size: 15px;
  }
</style>
</head>
<body>

<h1>Chat User Details</h1>
<div id="user-details" class="user-details">Loading...</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabaseUrl = "https://pwsxezhugsxosbwhkdvf.supabase.co";
const supabaseAnonKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB3c3hlemh1Z3N4b3Nid2hrZHZmIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MTkyODM4NywiZXhwIjoyMDY3NTA0Mzg3fQ.u7lU9gAE-hbFprFIDXQlep4q2bhjj0QdlxXF-kylVBQ";
const supabase = createClient(supabaseUrl, supabaseAnonKey);

const userDetailsDiv = document.getElementById('user-details');

// Step 1: Get user ID from localStorage
const chatUserId = localStorage.getItem('chatting');

if (!chatUserId) {
  userDetailsDiv.textContent = "⚠️ No chat user selected.";
} else {
  // Step 2: Fetch user details from Supabase
  const { data, error } = await supabase
    .from('fwebaccount')
    .select('*')
    .eq('id', chatUserId)
    .single();

  // Step 3: Display user details
  if (error || !data) {
    userDetailsDiv.textContent = "❌ Failed to load user details.";
  } else {
    userDetailsDiv.innerHTML = `
      ${data.profile_pic ? `<img src="${data.profile_pic}" alt="Profile">` : ''}
      <h2>${data.username || 'Unknown User'}</h2>
      <p><strong>Email:</strong> ${data.email || 'N/A'}</p>
      <p><strong>Bio:</strong> ${data.bio || 'No bio provided'}</p>
      <p><strong>ID:</strong> ${data.id}</p>
    `;
  }
}
</script>

</body>
</html>
