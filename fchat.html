<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>FCHAT</title>
<style>
  body {
    font-family: 'Poppins','Segoe UI',sans-serif;
    background: linear-gradient(135deg,#000,#1a1a1a);
    color:#fff;
    margin:0;
    display:flex;
    flex-direction:column;
    height:100vh;
    overflow:hidden;
  }
  .top-banner {
    height:60px;
    background:rgba(0,0,0,0.85);
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:0 15px;
    font-size:20px;
    font-weight:700;
    border-bottom:1px solid rgba(255,255,255,0.1);
  }
  .menu-btn { cursor:pointer; font-size:18px; }
  .main {
    flex:1;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    position:relative;
    padding-bottom:60px;
  }
  #logs { color:#00c6ff; font-size:15px; white-space:nowrap; margin-top:10px; opacity:0; transition:opacity 0.6s;}
  .fab {
    position:absolute;
    bottom:70px;
    right:20px;
    width:60px;
    height:60px;
    border-radius:50%;
    background:linear-gradient(135deg,#0072ff,#00c6ff);
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:28px;
    cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,0.3);
  }
  .bottom-nav {
    height:60px;
    background:rgba(0,0,0,0.85);
    display:flex;
    justify-content:space-around;
    align-items:center;
    border-top:1px solid rgba(255,255,255,0.1);
  }
  .nav-item { text-align:center; font-size:14px; cursor:pointer; opacity:0.8; }
  .nav-item.active { opacity:1; font-weight:700; }
</style>
</head>
<body>
  <div class="top-banner">
    <div>FCHAT</div>
    <div class="menu-btn" id="menuBtn">☰</div>
  </div>

  <div class="main" id="mainContent">
    <div id="loading">
      <h2>Loading FWEB data...</h2>
      <div id="logs"></div>
    </div>
    <div id="chatInterface" style="display:none;width:100%;height:100%;flex-direction:column;">
      <!-- WhatsApp style chat blank -->
      <div style="flex:1; display:flex; justify-content:center; align-items:center; font-size:18px; color:#aaa;">
        FCHAT Home
      </div>
      <div class="fab" id="addBtn">+</div>
    </div>
  </div>

  <div class="bottom-nav">
    <div class="nav-item active" id="navFchat">FCHAT</div>
    <div class="nav-item" id="navStatus">Status</div>
    <div class="nav-item" id="navUpdates">Updates</div>
    <div class="nav-item" id="navMe">Me</div>
  </div>

<script type="module">
const logsEl = document.getElementById('logs');
const loadingEl = document.getElementById('loading');
const chatInterface = document.getElementById('chatInterface');

// Floating Add button
document.getElementById('addBtn').addEventListener('click', ()=>{
  window.location.href='add.html';
});

// Menu button -> Settings
document.getElementById('menuBtn').addEventListener('click', ()=>{
  window.location.href='fchatsettings.html';
});

// Bottom nav click handlers
document.getElementById('navFchat').addEventListener('click', ()=>setActiveNav('navFchat'));
document.getElementById('navStatus').addEventListener('click', ()=>setActiveNav('navStatus'));
document.getElementById('navUpdates').addEventListener('click', ()=>setActiveNav('navUpdates'));
document.getElementById('navMe').addEventListener('click', ()=>setActiveNav('navMe'));

function setActiveNav(id){
  document.querySelectorAll('.nav-item').forEach(el=>el.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// Simulate logs & read user storage
async function loadFwebData(){
  const logSteps=[
    "Accessing device storage...",
    "Fetching FWEB data...",
    "Loading account details...",
    "Preparing FCHAT interface...",
    "✅ FCHAT ready!"
  ];

  let fwebData = null;

  try{
    // File System Access API read
    const dirHandle = await window.showDirectoryPicker();
    const fileHandle = await dirHandle.getFileHandle('fweb_account.json');
    const file = await fileHandle.getFile();
    const text = await file.text();
    fwebData = JSON.parse(text);
    console.log('FWEB data loaded:', fwebData);
  }catch(e){
    console.warn("Could not read user storage", e);
  }

  for(let step of logSteps){
    logsEl.style.opacity=0;
    await new Promise(r=>setTimeout(r,400));
    logsEl.textContent = step;
    logsEl.style.opacity=1;
    await new Promise(r=>setTimeout(r,1000));
  }

  loadingEl.style.display='none';
  chatInterface.style.display='flex';
}

loadFwebData();
</script>
</body>
</html>
