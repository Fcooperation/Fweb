<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fchat</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:white;
  padding: 0;
  margin: 0;
  overflow-x:hidden;
}

/* ---------- TOP BAR (WhatsApp style) ---------- */
#top-bar {
  width:100%;
  padding:15px 20px;
  background:white;
  color:black;
  font-size:25px;
  font-weight:bold;
  border-bottom:1px solid #ddd;
}

/* ---------- SEARCH BAR ---------- */
#search-box {
  width: calc(100% - 40px);
  margin:15px 20px;
  padding:10px 15px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
}

/* ---------- CHAT LIST ---------- */
#users-list {
  margin:10px 0 80px 0;
  display:flex;
  flex-direction:column;
  gap:12px;
  padding:0 15px;
}

.fcard {
  background:white;
  border-bottom:1px solid #eee;
  padding:12px 5px;
  display:flex;
  align-items:center;
  gap:14px;
}

.pfp {
  width:55px;
  height:55px;
  border-radius:50%;
  background:black;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:bold;
  font-size:20px;
  cursor:pointer;
  overflow:hidden;
}

.pfp img {
  width:100%;
  height:100%;
  border-radius:50%;
  object-fit:cover;
}

.username {
  font-size:18px;
  font-weight:600;
}

.userid {
  font-size:12px;
  color:#777;
}

/* ---------- FLOATING ADD BUTTON ---------- */
#add-btn {
  position:fixed;
  right:20px;
  bottom:90px;
  width:55px;
  height:55px;
  background:#2196f3;
  color:white;
  border:none;
  border-radius:50%;
  font-size:30px;
  font-weight:bold;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
  box-shadow:0 5px 10px rgba(0,0,0,0.2);
}

/* ---------- BOTTOM NAV BAR ---------- */
#bottom-nav {
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  height:60px;
  background:white;
  border-top:1px solid #ddd;
  display:flex;
  justify-content:space-around;
  align-items:center;
  font-size:14px;
}

.nav-item {
  text-align:center;
  color:#555;
  cursor:pointer;
}

.nav-item.active {
  color:black;
  font-weight:bold;
}

/* ---------- MODAL ---------- */
#profile-modal {
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.85);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:2000;
}

#profile-modal img {
  width:75%;
  max-width:350px;
  border-radius:50%;
}
</style>
</head>

<body>

<!-- TOP BAR -->
<div id="top-bar">FCHAT</div>

<!-- SEARCH BAR -->
<input id="search-box" type="text" placeholder="Searchâ€¦">

<!-- CHAT LIST -->
<div id="users-list"></div>

<!-- FLOATING ADD BUTTON -->
<div id="add-btn" onclick="location.href='add.html'">+</div>

<!-- PROFILE MODAL -->
<div id="profile-modal">
  <img id="modal-img">
</div>

<!-- BOTTOM NAV -->
<div id="bottom-nav">
  <div class="nav-item active">Fchat</div>
  <div class="nav-item" onclick="location.href='fvids.html'">Fvids</div>
  <div class="nav-item" onclick="location.href='fchatupdates.html'">Updates</div>
  <div class="nav-item" onclick="location.href='fchatme.html'">Me</div>
</div>

<script>
/* LOAD SAVED CHATS */
let allChats = [];

function loadSavedChats() {
  allChats = JSON.parse(localStorage.getItem("fchat_messages")) || [];
  displayChats(allChats);
}

/* DISPLAY CHATS */
function displayChats(chats) {
  const box = document.getElementById("users-list");
  box.innerHTML = "";

  chats.forEach(user => {
    const card = document.createElement("div");
    card.className = "fcard";

    let pfp = document.createElement("div");
    pfp.className = "pfp";

    if (user.profile_pic) {
      let img = document.createElement("img");
      img.src = user.profile_pic;
      pfp.appendChild(img);

      pfp.onclick = () => {
        document.getElementById("profile-modal").style.display = "flex";
        document.getElementById("modal-img").src = user.profile_pic;
      };
    } else {
      pfp.textContent = user.username?.[0]?.toUpperCase() || "U";
    }

    let info = document.createElement("div");
    info.innerHTML = `
      <div class="username">${user.username}</div>
      <div class="userid">ID: ${user.id}</div>
    `;

    card.appendChild(pfp);
    card.appendChild(info);
    box.appendChild(card);
  });
}

/* CLOSE MODAL */
document.getElementById("profile-modal").onclick = () => {
  document.getElementById("profile-modal").style.display = "none";
};

/* SEARCH FILTER */
document.getElementById("search-box").addEventListener("input", function() {
  const text = this.value.toLowerCase();
  const filtered = allChats.filter(u =>
    u.username.toLowerCase().includes(text)
  );
  displayChats(filtered);
});

/* START */
loadSavedChats();
</script>

</body>
  </html>
